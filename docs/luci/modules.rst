.. _luci-modules:
.. vim: syntax=rst
.. vim: textwidth=72
.. vim: spell spelllang=ru,en

===========
Модули LuCI
===========

.. contents::

Категории модулей
=================

Модули LuCI делятся на несколько категорий и располагаются в разных папках:

* **applications** (одно приложение или плагин для других модулей или приложений)
* **i18n** (файлы перевода)
* **libs** (независимые библиотеки)
* **modules** (наборы приложений)
* **themes** (темы интерфейса)

Структура модуля
----------------

Makefile
^^^^^^^^

Каждый модуль в корне должен содержать Makefile. Если модуль содержит только
исходный код Lua, то его содержимое должно состоять из::

  include ../../build/config.mk
  include ../../build/module.mk

Если в модуле есть код на C(++), то в Makefile должен содержать следующее::

  include ../../build/config.mk
  include ../../build/gccconfig.mk
  include ../../build/module.mk

  compile:
    # команды для компиляции и компоновки C(++)-кода
    # команды для очистки собранных объектов

Директории
^^^^^^^^^^^

src
"""

Этот каталог предназначен для исходного кода C(++).

luasrc
""""""

Содержит все файлы исходного кода Lua. Они автоматически удаляются или
скомпилированы, в зависимости от сборки и установлены в каталог установки LuCI.

lua
"""

Директория **lua** эквивалента **luasrc**, но папки, содержащие lua-файлы и сами
lua-файлы будут установлены в корневую папку Lua целевой сборки.

htdocs
""""""

Все файлы из **htdocs** будут скопированы в корневой каталог веб-сервера.

root
""""

Все папки и файлы из **root** будут скопированы в корень целевой сборки без
изменений.

dist
""""

Директория **dist** зарезервирована для построения и создания рабочего дерева установки,
которое будет представлять файловую систему на целевой машине.
**НЕ ПОМЕЩАЙТЕ** здесь файлы, так как они будут удалены.

ipkg
""""

Содержит пакет управляющих фалов IPKG, такие как *preinst*, *posinst*, *prerm*, *postrm*,
*conffiles*.
